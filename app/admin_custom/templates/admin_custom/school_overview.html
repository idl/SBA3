{% extends "admin_custom/admin_custom_base.html" %}
{% load bootstrap3 %}

{% block admin_main_content %}
  {% if request.user.is_superuser %}
    <div class="row">
      <div class="col-xs-12">
        <a href="{% url 'superadmin_overview' %}" class="btn btn-default btn-sm">
          {% bootstrap_icon 'arrow-left' %}&emsp;BACK TO SUPERADMIN OVERVIEW PANEL
        </a>
      </div>
    </div>
    <hr>
  {% endif %}
  <div class="row">
    <div class="col-xs-12">
      {% bootstrap_messages %}
      <h2 class="admin-main-title">{{ admin_main_title }}</h2>
      {% if select_survey_year_form %}
        <form action="{% url 'admin_select_survey_year' school_id %}" method="POST"
          class="form-inline select-survey-year-form">
          <div class="wrap">
            {% csrf_token %}
            {% bootstrap_form select_survey_year_form %}
            {% buttons %}
              <button class="btn btn-primary btn-block btn-xs" type="submit">
                Change Survey Year
              </button>
            {% endbuttons %}
          </div>
        </form>
      {% endif %}
      {% if no_surveys_error %}
        <p class="bg-warning pull-right">{{ no_surveys_error }}</p>
      {% endif %}
    </div>
  </div>
  <div class="row">
    <div class="col-xs-12">
      <h3>Add Students</h3>
      <div class="add-students-forms bg-gray">
        <div class="row">
          <div class="col-xs-6">
            <h4><strong>Upload .csv File</strong> <span class="text-muted">(bulk add students)</span></h4>
            <h5>File Format</h5>
            <p>Please upload a <code>.csv</code> file and include the following information for each student in the given order:</p>
            <ul>
              <li>Student Identifier/Username</li>
              <li>Student Email Address</li>
            </ul>
            <p>Please submit the file using the same format as the sample file:</p>
            <p><a href="/static/example.csv">Download sample .csv file</a></p>
            <hr>
            <form action="{% url 'admin_add_students_bulk' school_id %}" method="POST"
              class="form-inline" enctype="multipart/form-data">
              {% csrf_token %}
              {% bootstrap_form add_students_bulk_form %}
              {% buttons %}
                <button class="btn btn-primary btn-block btn-xs" type="submit">
                  {% bootstrap_icon 'upload' %} UPLOAD
                </button>
              {% endbuttons %}
            </form>
          </div>
          <div class="col-xs-6">
            <h4><strong>Add Single Student</strong></h4>
            <form action="{% url 'admin_add_student_single' school_id %}" method="POST"
              class="form" enctype="multipart/form-data">
              {% csrf_token %}
              {% bootstrap_form add_student_single_form %}
              {% buttons %}
                <button class="btn btn-primary btn-block btn-xs" type="submit">
                  {% bootstrap_icon 'plus' %} ADD
                </button>
              {% endbuttons %}
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-xs-12">
      <h3>Student Roster</h3>
      <table class="table table-striped table-hover table-condensed">
        <thead>
          <tr>
            <td><b>#</b></td>
            <td><b>Student Identifier (UID)</b></td>
            <td><b>Student Email</b></td>
            <td><b>Continuation Passkey</b></td>
            <td><b>Started Survey?</b></td>
            <td><b>Completed Survey?</b></td>
            <td style="min-width: 100px;"><b>Actions</b></td>
          </tr>
        </thead>
        <tbody>
          {% for student in students_list %}
            <tr>
              <td><small><em>{{student.index}}</em></small></td>
              <td>{{student.uid}}</td>
              <td>{{student.email}}</td>
              <td>{{student.continue_pass}}</td>
              <td class={% if student.started %}"success"{% else %}"danger"{% endif %}>
                {{student.started}}
              </td>
              <td class={% if student.completed %}"success"{% else %}"danger"{% endif %}>
                {{student.completed}}
              </td>
              <td style="min-width: 100px;">
                <a href="{# url 'admin_delete_student' school_id student.id #}"
                   class="btn btn-default btn-xs" data-toggle="tooltip"
                   data-placement="top" title="View Student Results">
                    {% bootstrap_icon 'eye-open' %}
                </a>
                <a href="{% url 'admin_edit_student' school_id student.id %}"
                   class="btn btn-primary btn-xs" data-toggle="tooltip"
                   data-placement="top" title="Edit Student">
                    {% bootstrap_icon 'pencil' %}
                </a>
                <a href="{% url 'admin_delete_student' school_id student.id %}"
                   class="btn btn-danger btn-xs" data-toggle="tooltip"
                   data-placement="top" title="Delete Student">
                    {% bootstrap_icon 'remove' %}
                </a>
              </td>
            </tr>
          {% empty %}
            <tr>
              <td colspan="4">There aren't any students. Please add one by using the above form.</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
{% endblock %}


{% block admin_main_content_js %}
<script>
  $(document).ready(function() {
    $('[data-toggle="tooltip"]').tooltip();
  });
</script>
{% endblock %}

{% block admin_modals_content %}
{% endblock %}

{% block admin_modals_js %}
{% endblock %}