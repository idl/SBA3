{% extends "admin_custom/admin_custom_base.html" %}

{% block highcharts %}
  <script src="/static/js/highcharts.js"></script>
{% endblock %}

{% block header %}
  <header>
    <div class="container">
      <div class="row page-header">
        <div class="col-xs-6">
          <h1>SBA-3</h1>
        </div>
        <div class="col-xs-5 text-right">
          <span class="logout text-muted" style="display:inline-block; padding-bottom: 3px; border-bottom: 2px solid #cccccc;">{{ currentUserEmail }}</span>
        </div>
        <div class="col-xs-1 text-right">
          <a href="{% url 'logout_view' %}" class="btn btn-default btn-sm logout">Log Out&nbsp;&nbsp;<span class="glyphicon glyphicon-log-out"></span></a>
        </div>
      </div>
    </div>
  </header>
{% endblock %}

{% block admin_page %}
  <section class="container admin-page">
    <div class="row">
      <div class="col-xs-12 admin-nav">
        <a href="/admin#surveys" class="btn btn-default">
          <span class="glyphicon glyphicon-arrow-left"></span>
          Go Back
        </a>
      </div>
    </div>
    <br>
    <div class="row">
      <div class="col-xs-12 tab-content">
        <div class='row'>
          <div class='col-xs-12'>
            <h2>{{ school.name }}</h2>
          </div>
        </div>
        <div class="row">
          <div class="col-xs-12">
            HIGHCHARTS
          </div>
        </div>
        {% if isSuperuser == False %}
          {% if roster_uid_err %}
            <div class='alert alert-danger' role='alert'>
              {{ roster_uid_err }}
            </div>
          {% endif %}
          {% if roster_file_err %}
            <div class='alert alert-danger' role='alert'>
              {{ roster_file_err }}
            </div>
          {% endif %}
          <form action='{% url "update_roster" school.id %}' method='post' role='form' class='uploadForm'>
            {% csrf_token %}
            <div class='row'>
              <div class='col-xs-4'>
                <div class='form-group pull-down-4'>
                  <label for='uid'>User ID</label>
                  <input name="uid" id="uid" />
                </div>
              </div>
              <div class='col-xs-5'>
              </div>
              <div class='col-xs-3'>
                <div class='form-group'>
                  <input type='submit' class='btn btn-primary btn-block' value='Add User'>
                </div>
              </div>
            </div>
          </form>
          <br>
          <form action='{% url "upload_roster" school.id %}' method='post' role='form' class='uploadForm' enctype='multipart/form-data'>
            {% csrf_token %}
            <div class='row'>
              <div class='col-xs-9'>
                <div class='form-group'>
                  <label for='upload'>User ID List <br> (seperate user id's with either a comma [,] or by putting each on its own line)</label>
                  <input type="file" name="uid_list" id='upload' />
                </div>
              </div>
              <div class='col-xs-3'>
                <div class='form-group pull-down-15'>
                  <input type='submit' class='btn btn-primary btn-block' value='Upload' />
                </div>
              </div>
            </div>
          </form>
        {% endif %}
          <div class='row'>
            <div class='col-xs-12'>
              <h3>Roster</h3>
              <table class="table table-striped users-table global-admins">
                <thead>
                  <tr>
                    <th>User ID</th>
                    <th>Active</th>
                    <th>Continuation Password</th>
                    <th>Completed</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                {% for uid, info in roster_list.items %}
                  <tr>
                    <td>{{ uid }}</td>
                    <td>{{ info.active }}</td>
                    <td>{{ info.continue }}</td>
                    <td>{{ info.complete }}</td>
                    <td>
                      {% if info.id %}
                        <a href="{% url 'school_student_data' school.id info.id %}">
                          <span class="glyphicon glyphicon-eye-open"></span>
                        </a>
                      {% else %}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                      {% endif %}
                      <a href="{% url 'remove_roster' school.id uid %}">
                        <span class="glyphicon glyphicon-remove"></span>
                      </a>
                    </td>
                  </tr>
                {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
  </section>
{% endblock %}
